<h1 class="h3">Reconnaître les intervalles</h1>

<div class="accordion" id="accordionExample">
    <div class="accordion-item">
        <h2 class="accordion-header" id="headingOne">
            <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                Entraînement
            </button>
        </h2>
        <div id="collapseOne" class="accordion-collapse show" aria-labelledby="headingOne" data-bs-parent="#accordionExample">
            <div class="accordion-body">
              <div class="row">
                <div class="col text-center">
                  Score: {{ rightAnswers.length }} / {{ questions.length }} ({{ utilitiesService.getPercentage(rightAnswers.length, questions.length) }}%)
                </div>
              </div>
              <div class="row mt-2">
                <div class="col text-center">
                  <div class="musiqwik">&={{ intervalNotes[0].musiqwikText }}={{ intervalNotes[1].musiqwikText }}=!</div> 
                </div>
              </div>
              <div class="row mt-2">
                <div class="col text-center {{ feedbackColor }}">
                  {{ feedbackText }}
                </div>
              </div>
              <div class="row">
                <form>
                  <div class="form-group">
                    <label for="responseSelect" class="form-label mt-4">Choisissez une réponse</label>
                    <select 
                      class="form-select" 
                      name="response-select" 
                      id="responseSelect"
                      [(ngModel)]="selResponse"
                      [disabled]="responseSelectIsDisabled"
                    >
                      <option *ngFor="let interval of getSelLevelsIntervals()" [ngValue]="interval">{{ interval.name }}</option>
                    </select>
                  </div>
                </form>
              </div>
              <div class="row justify-content-around mt-3">
                <button 
                  type="button" 
                  class="btn btn-primary col-4" 
                  [disabled]="areButtonsDisabled[0]"
                  (click)="generateInterval()"
                >
                  Nouvelle question
                </button>
                <button 
                  type="button" 
                  class="btn btn-primary col-4" 
                  [disabled]="areButtonsDisabled[1]"
                  (click)="checkAnswer()"
                >
                  Corriger
                </button>
              </div>
            </div>
        </div>
    </div>
    <div class="accordion-item">
      <h2 class="accordion-header" id="headingTwo">
        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
          Options
        </button>
      </h2>
      <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#accordionExample">
        <div class="accordion-body">
           <form>
              <div class="form-group">
                <label for="levelSelect" class="form-label mt-4">Niveau sélectionné</label>
                <select 
                  class="form-select" 
                  [(ngModel)]="selLevel" 
                  name="level-select" 
                  id="levelSelect" 
                  (change)="saveSelLevel()"
                >
                   <option *ngFor="let level of levels" [ngValue]="level">{{ level.description }}</option>
                </select>
              </div>
           </form>
        </div>
      </div>
    </div>
    <div class="accordion-item">
      <h2 class="accordion-header" id="headingThree">
        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
          Statistiques
        </button>
      </h2>
      <div id="collapseThree" class="accordion-collapse collapse" aria-labelledby="headingThree" data-bs-parent="#accordionExample">
        <div class="accordion-body">
          <table class="table">
            <thead>
              <tr>
                <th scope="col">Niveau</th>
                <th scope="col">Score</th>
                <th scope="col">Pourcentage de réussite</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let level of levels">
                <td>{{ level.description }}</td>
                <td>{{ getRightAnsByLevel(level.id).length }} / {{ getQuestionsByLevel(level.id).length }}</td>
                <td>
                  <div class="progress">
                    <div 
                      class="progress-bar bg-{{ getProgressbarColorClass(level.id) }}" 
                      role="progressbar" 
                      [ngStyle]="{width: getStatsPercentageByLevel(level.id) + '%'}" 
                      attr.aria-valuenow="{{ getStatsPercentageByLevel(level.id) }}" 
                      aria-valuemin="0" 
                      aria-valuemax="100"
                    >
                      {{ getStatsPercentageByLevel(level.id) }}%
                    </div>
                  </div>
                </td>
              </tr>
              <tr class="fw-bold">
                <td>Total</td>
                <td>{{ rightAnswers.length }} / {{ questions.length }}</td>
                <td>
                  <div class="progress">
                    <div 
                      class="progress-bar bg-{{ getProgressbarColorClass(-1) }}" 
                      role="progressbar" 
                      [ngStyle]="{width: utilitiesService.getPercentage(rightAnswers.length, questions.length) + '%'}" 
                      attr.aria-valuenow="{{ utilitiesService.getPercentage(rightAnswers.length, questions.length) }}" 
                      aria-valuemin="0" 
                      aria-valuemax="100"
                    >
                      {{ utilitiesService.getPercentage(rightAnswers.length, questions.length) }}%
                    </div>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
          <!-- Button trigger modal -->
          <button 
            type="button" 
            class="btn btn-danger" 
            data-bs-toggle="modal" 
            data-bs-target="#initStatsModal"
            *ngIf="questions.length > 0"
          >
            Réinitialiser les statistiques
          </button>

          <!-- Modal -->
          <div class="modal fade" id="initStatsModal" tabindex="-1" aria-labelledby="initStatsModalLabel" aria-hidden="true">
            <div class="modal-dialog">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title" id="initStatsModalLabel">Réinitialiser les statistiques</h5>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                  Êtes-vous sûr(e) de vouloir réinitialiser les statistiques?
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Non</button>
                  <button type="button" class="btn btn-danger" data-bs-dismiss="modal" (click)="initStats()">Oui</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
</div>

 
